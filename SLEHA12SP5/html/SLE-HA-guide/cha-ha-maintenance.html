<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLE HA 12 SP5 | Administration Guide | Executing Maintenance Tasks</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Executing Maintenance Tasks | SLE HA 12 SP5"/>
<meta name="description" content="To perform maintenance tasks on the cluster nodes, you…"/>
<meta name="product-name" content="SUSE Linux Enterprise High Availability"/>
<meta name="product-number" content="12 SP5"/>
<meta name="book-title" content="Administration Guide"/>
<meta name="chapter-title" content="Chapter 23. Executing Maintenance Tasks"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Linux Enterprise High Availability Extension 12 SP5"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Executing Maintenance Tasks | SLE HA 12 SP5"/>
<meta property="og:description" content="To perform maintenance tasks on the cluster nodes, you might need to stop the resources running on that node, to move them, …"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Executing Maintenance Tasks | SLE HA 12 SP5"/>
<meta name="twitter:description" content="To perform maintenance tasks on the cluster nodes, you might need to stop the resources running on that node, to move them, …"/>
<link rel="prev" href="part-maintenance.html" title="Part IV. Maintenance and Upgrade"/><link rel="next" href="cha-ha-migration.html" title="Chapter 24. Upgrading Your Cluster and Updating Software Packages"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"> </script><script src="static/js/script.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Administration Guide</a><span> / </span><a class="crumb" href="part-maintenance.html">Maintenance and Upgrade</a><span> / </span><a class="crumb" href="cha-ha-maintenance.html">Executing Maintenance Tasks</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Administration Guide</div><ol><li><a href="pre-ha.html" class=" "><span class="title-number"> </span><span class="title-name">About This Guide</span></a></li><li><a href="part-install.html" class="has-children "><span class="title-number">I </span><span class="title-name">Installation and Setup</span></a><ol><li><a href="cha-ha-concepts.html" class=" "><span class="title-number">1 </span><span class="title-name">Product Overview</span></a></li><li><a href="cha-ha-requirements.html" class=" "><span class="title-number">2 </span><span class="title-name">System Requirements and Recommendations</span></a></li><li><a href="cha-ha-install.html" class=" "><span class="title-number">3 </span><span class="title-name">Installing SUSE Linux Enterprise High Availability</span></a></li><li><a href="cha-ha-setup.html" class=" "><span class="title-number">4 </span><span class="title-name">Using the YaST Cluster Module</span></a></li></ol></li><li><a href="part-config.html" class="has-children "><span class="title-number">II </span><span class="title-name">Configuration and Administration</span></a><ol><li><a href="cha-ha-config-basics.html" class=" "><span class="title-number">5 </span><span class="title-name">Configuration and Administration Basics</span></a></li><li><a href="cha-conf-hawk2.html" class=" "><span class="title-number">6 </span><span class="title-name">Configuring and Managing Cluster Resources with Hawk2</span></a></li><li><a href="cha-ha-manual-config.html" class=" "><span class="title-number">7 </span><span class="title-name">Configuring and Managing Cluster Resources (Command Line)</span></a></li><li><a href="cha-ha-agents.html" class=" "><span class="title-number">8 </span><span class="title-name">Adding or Modifying Resource Agents</span></a></li><li><a href="cha-ha-fencing.html" class=" "><span class="title-number">9 </span><span class="title-name">Fencing and STONITH</span></a></li><li><a href="cha-ha-storage-protect.html" class=" "><span class="title-number">10 </span><span class="title-name">Storage Protection and SBD</span></a></li><li><a href="cha-ha-acl.html" class=" "><span class="title-number">11 </span><span class="title-name">Access Control Lists</span></a></li><li><a href="cha-ha-netbonding.html" class=" "><span class="title-number">12 </span><span class="title-name">Network Device Bonding</span></a></li><li><a href="cha-ha-lb.html" class=" "><span class="title-number">13 </span><span class="title-name">Load Balancing</span></a></li><li><a href="cha-ha-geo.html" class=" "><span class="title-number">14 </span><span class="title-name">Geo Clusters (Multi-Site Clusters)</span></a></li></ol></li><li><a href="part-storage.html" class="has-children "><span class="title-number">III </span><span class="title-name">Storage and Data Replication</span></a><ol><li><a href="cha-ha-storage-dlm.html" class=" "><span class="title-number">15 </span><span class="title-name">Distributed Lock Manager (DLM)</span></a></li><li><a href="cha-ha-ocfs2.html" class=" "><span class="title-number">16 </span><span class="title-name">OCFS2</span></a></li><li><a href="cha-ha-gfs2.html" class=" "><span class="title-number">17 </span><span class="title-name">GFS2</span></a></li><li><a href="cha-ha-drbd.html" class=" "><span class="title-number">18 </span><span class="title-name">DRBD</span></a></li><li><a href="cha-ha-clvm.html" class=" "><span class="title-number">19 </span><span class="title-name">Cluster Logical Volume Manager (cLVM)</span></a></li><li><a href="cha-ha-cluster-md.html" class=" "><span class="title-number">20 </span><span class="title-name">Cluster Multi-device (Cluster MD)</span></a></li><li><a href="cha-ha-samba.html" class=" "><span class="title-number">21 </span><span class="title-name">Samba Clustering</span></a></li><li><a href="cha-ha-rear.html" class=" "><span class="title-number">22 </span><span class="title-name">Disaster Recovery with Relax-and-Recover (ReaR)</span></a></li></ol></li><li class="active"><a href="part-maintenance.html" class="has-children you-are-here"><span class="title-number">IV </span><span class="title-name">Maintenance and Upgrade</span></a><ol><li><a href="cha-ha-maintenance.html" class=" you-are-here"><span class="title-number">23 </span><span class="title-name">Executing Maintenance Tasks</span></a></li><li><a href="cha-ha-migration.html" class=" "><span class="title-number">24 </span><span class="title-name">Upgrading Your Cluster and Updating Software Packages</span></a></li></ol></li><li><a href="part-appendix.html" class="has-children "><span class="title-number">V </span><span class="title-name">Appendix</span></a><ol><li><a href="app-ha-troubleshooting.html" class=" "><span class="title-number">A </span><span class="title-name">Troubleshooting</span></a></li><li><a href="app-naming.html" class=" "><span class="title-number">B </span><span class="title-name">Naming Conventions</span></a></li><li><a href="app-ha-management.html" class=" "><span class="title-number">C </span><span class="title-name">Cluster Management Tools (Command Line)</span></a></li><li><a href="app-crmreport-nonroot.html" class=" "><span class="title-number">D </span><span class="title-name">Running Cluster Reports Without <code class="systemitem">root</code> Access</span></a></li></ol></li><li><a href="gl-heartb.html" class=" "><span class="title-number"> </span><span class="title-name">Glossary</span></a></li><li><a href="bk01ape.html" class=" "><span class="title-number">E </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-ha-maintenance" data-id-title="Executing Maintenance Tasks"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname">SUSE Linux Enterprise High Availability</span> <span class="productnumber">12 SP5</span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">23 </span><span class="title-name">Executing Maintenance Tasks</span></span> <a title="Permalink" class="permalink" href="cha-ha-maintenance.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div></div><div><div class="abstract"><p>
    To perform maintenance tasks on the cluster nodes, you might need to stop
    the resources running on that node, to move them, or to shut down or reboot
    the node. It might also be necessary to temporarily take over the control of
    resources from the cluster, or even to stop the cluster service while resources
    remain running.
   </p><p>
    This chapter explains how to manually take down a cluster node without
    negative side effects. It also gives an overview of different options the
    cluster stack provides for executing maintenance tasks.
   </p></div></div></div></div><section class="sect1" id="sec-ha-maint-shutdown-node" data-id-title="Implications of Taking Down a Cluster Node"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.1 </span><span class="title-name">Implications of Taking Down a Cluster Node</span></span> <a title="Permalink" class="permalink" href="cha-ha-maintenance.html#sec-ha-maint-shutdown-node">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   When you shut down or reboot a cluster node (or stop the Pacemaker service on a
   node), the following processes will be triggered:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     The resources that are running on the node will be stopped or moved off
     the node.
    </p></li><li class="listitem"><p>
     If stopping the resources should fail or time out, the STONITH mechanism
     will fence the node and shut it down.
    </p></li></ul></div><div class="procedure" id="pro-ha-maint-shutdown-node" data-id-title="Manually Rebooting a Cluster Node"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 23.1: </span><span class="title-name">Manually Rebooting a Cluster Node </span></span><a title="Permalink" class="permalink" href="cha-ha-maintenance.html#pro-ha-maint-shutdown-node">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><p>
    If your aim is to move the services off the node in an orderly fashion
    before shutting down or rebooting the node, proceed as follows:
   </p><ol class="procedure" type="1"><li class="step"><p>
     On the node you want to reboot or shut down, log in as <code class="systemitem">root</code> or
     equivalent.
    </p></li><li class="step"><p>
     Put the node into <code class="literal">standby</code> mode:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>crm node standby</pre></div><p>
     That way, services can migrate off the node without being limited by the
     shutdown timeout of Pacemaker.
    </p></li><li class="step"><p>
     Check the cluster status with:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>crm status</pre></div><p>
     It shows the respective node in <code class="literal">standby</code> mode:
    </p><div class="verbatim-wrap"><pre class="screen">[...]
Node <em class="replaceable">bob</em>: standby
[...]</pre></div></li><li class="step"><p>
     Stop the Pacemaker service on that node:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>systemctl stop pacemaker.service</pre></div></li><li class="step"><p>
     Reboot the node.
    </p></li></ol></div></div><p>
   To check if the node joins the cluster again:
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Log in to the node as <code class="systemitem">root</code> or equivalent.
    </p></li><li class="step"><p>
     Check if the Pacemaker service has started:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>systemctl status pacemaker.service</pre></div></li><li class="step"><p>
     If not, start it:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>systemctl start pacemaker.service</pre></div></li><li class="step"><p>
     Check the cluster status with:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>crm status</pre></div><p>
     It should show the node coming online again.
    </p></li></ol></div></div></section><section class="sect1" id="sec-ha-maint-overview" data-id-title="Different Options for Maintenance Tasks"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.2 </span><span class="title-name">Different Options for Maintenance Tasks</span></span> <a title="Permalink" class="permalink" href="cha-ha-maintenance.html#sec-ha-maint-overview">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Pacemaker offers a variety of options for performing system maintenance:
  </p><div class="variablelist"><dl class="variablelist"><dt id="vle-ha-maint-mode-cluster"><span class="term"><a class="xref" href="cha-ha-maintenance.html#sec-ha-maint-mode-cluster" title="23.4. Putting the Cluster into Maintenance Mode">Putting the Cluster into Maintenance Mode</a></span></dt><dd><p>
      The global cluster property <code class="literal">maintenance-mode</code> puts all
      resources into maintenance state at once. The cluster stops monitoring them
      and becomes oblivious to their status. Note that only the resource management
      by Pacemaker is disabled. Corosync and SBD are still functional. Use maintenance
      mode for any tasks involving cluster resources. For any tasks involving
      infrastructure such as storage or networking, the safest method is to stop
      the cluster services completely. See <a class="xref" href="cha-ha-maintenance.html#sec-ha-maint-shutdown-node" title="23.1. Implications of Taking Down a Cluster Node">Section 23.1, “Implications of Taking Down a Cluster Node”</a>.
     </p></dd><dt id="vle-ha-maint-mode-node"><span class="term"><a class="xref" href="cha-ha-maintenance.html#sec-ha-maint-mode-node" title="23.5. Putting a Node into Maintenance Mode">Putting a Node into Maintenance Mode</a></span></dt><dd><p>
      This option allows you to put all resources running on a specific node into
      maintenance state at once. The cluster will cease monitoring them and thus
      become oblivious to their status.
     </p></dd><dt id="vle-ha-maint-node-standby"><span class="term"><a class="xref" href="cha-ha-maintenance.html#sec-ha-maint-node-standby" title="23.6. Putting a Node into Standby Mode">Putting a Node into Standby Mode</a></span></dt><dd><p>
      A node that is in standby mode can no longer run resources. Any resources
      running on the node will be moved away or stopped (in case no other node
      is eligible to run the resource). Also, all monitoring operations will be
      stopped on the node (except for those with
      <code class="literal">role="Stopped"</code>).
     </p><p>
      You can use this option if you need to stop a node in a cluster while
      continuing to provide the services running on another node.
     </p></dd><dt id="vle-ha-maint-mode-rsc"><span class="term"><a class="xref" href="cha-ha-maintenance.html#sec-ha-maint-mode-rsc" title="23.7. Putting a Resource into Maintenance Mode">Putting a Resource into Maintenance Mode</a></span></dt><dd><p>
      When this mode is enabled for a resource, no monitoring operations will be
      triggered for the resource.
     </p><p>
      Use this option if you need to manually touch the service that is managed
      by this resource and do not want the cluster to run any monitoring
      operations for the resource during that time.
     </p></dd><dt id="vle-ha-maint-rsc-unmanaged"><span class="term"><a class="xref" href="cha-ha-maintenance.html#sec-ha-maint-rsc-unmanaged" title="23.8. Putting a Resource into Unmanaged Mode">Putting a Resource into Unmanaged Mode</a></span></dt><dd><p>
      The <code class="option">is-managed</code> meta attribute allows you to temporarily
      <span class="quote">“<span class="quote">release</span>”</span> a resource from being managed by the cluster
      stack. This means you can manually touch the service that is managed by
      this resource (for example, to adjust any components). However, the
      cluster will continue to <span class="emphasis"><em>monitor</em></span> the resource and to
      report any failures.
     </p><p>
      If you want the cluster to also cease <span class="emphasis"><em>monitoring</em></span> the
      resource, use the per-resource maintenance mode instead (see
      <a class="xref" href="cha-ha-maintenance.html#vle-ha-maint-mode-rsc">Putting a Resource into Maintenance Mode</a>).
     </p></dd></dl></div></section><section class="sect1" id="sec-ha-maint-outline" data-id-title="Preparing and Finishing Maintenance Work"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.3 </span><span class="title-name">Preparing and Finishing Maintenance Work</span></span> <a title="Permalink" class="permalink" href="cha-ha-maintenance.html#sec-ha-maint-outline">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div></div></div></div><div id="id-1.3.6.3.5.2" data-id-title="Risk of Data Loss" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><div class="admon-title">Warning: Risk of Data Loss</div><p>
    If you need to do testing or maintenance work, follow the general steps
    below.
   </p><p>
    Otherwise you risk unwanted side effects, like resources not starting in an
    orderly fashion, unsynchronized CIBs across the cluster nodes, or even data loss.
   </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Before you start, choose which of the options outlined in
     <a class="xref" href="cha-ha-maintenance.html#sec-ha-maint-overview" title="23.2. Different Options for Maintenance Tasks">Section 23.2</a> is appropriate for your situation.
    </p></li><li class="step"><p>
     Apply this option with Hawk2 or crmsh.
    </p></li><li class="step"><p>
     Execute your maintenance task or tests.
    </p></li><li class="step"><p>
     After you have finished, put the resource, node or cluster back to
     <span class="quote">“<span class="quote">normal</span>”</span> operation.
    </p></li></ol></div></div></div></section><section class="sect1" id="sec-ha-maint-mode-cluster" data-id-title="Putting the Cluster into Maintenance Mode"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.4 </span><span class="title-name">Putting the Cluster into Maintenance Mode</span></span> <a title="Permalink" class="permalink" href="cha-ha-maintenance.html#sec-ha-maint-mode-cluster">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div></div></div></div><div id="id-1.3.6.3.6.2" data-id-title="Maintenance mode only disables Pacemaker" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><div class="admon-title">Warning: Maintenance mode only disables Pacemaker</div><p>
    When putting a cluster into maintenance mode, only the resource management
    by Pacemaker is disabled. Corosync and SBD are still functional. Depending
    on your maintainence tasks, this might lead to fence operations.
   </p><p>
    Use maintenance mode for any tasks involving cluster resources. For any tasks
    involving infrastructure such as storage or networking, the safest method is to stop
    the cluster services completely. See <a class="xref" href="cha-ha-maintenance.html#sec-ha-maint-shutdown-node" title="23.1. Implications of Taking Down a Cluster Node">Section 23.1, “Implications of Taking Down a Cluster Node”</a>.
   </p></div><p>
    To put the cluster into maintenance mode on the crm shell, use the following command:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm</code> configure property maintenance-mode=true</pre></div><p>
    To put the cluster back into normal mode after your maintenance work is done, use the following command:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm</code> configure property maintenance-mode=false</pre></div><div class="procedure" id="pro-ha-maint-mode-cluster-hawk2" data-id-title="Putting the Cluster into Maintenance Mode with Hawk2"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 23.2: </span><span class="title-name">Putting the Cluster into Maintenance Mode with Hawk2 </span></span><a title="Permalink" class="permalink" href="cha-ha-maintenance.html#pro-ha-maint-mode-cluster-hawk2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Start a Web browser and log in to the cluster as described in
     <a class="xref" href="cha-conf-hawk2.html#sec-conf-hawk2-login" title="6.2. Logging In">Section 6.2, “Logging In”</a>.
    </p></li><li class="step"><p>
     In the left navigation bar, select <span class="guimenu">Cluster
     Configuration</span>.
    </p></li><li class="step"><p>
     In the <span class="guimenu">CRM Configuration</span> group, select the
     <span class="guimenu">maintenance-mode</span> attribute from the empty drop-down box
     and click the plus icon to add it.
    </p></li><li class="step"><p>
     To set <code class="literal">maintenance-mode=true</code>, activate the check box
     next to <code class="literal">maintenance-mode</code> and confirm your changes.
    </p></li><li class="step"><p>
     After you have finished the maintenance task for the whole cluster,
     deactivate the check box next to the <code class="literal">maintenance-mode</code>
     attribute.
    </p><p>
     From this point on, High Availability will take over cluster management again.
    </p></li></ol></div></div></section><section class="sect1" id="sec-ha-maint-mode-node" data-id-title="Putting a Node into Maintenance Mode"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.5 </span><span class="title-name">Putting a Node into Maintenance Mode</span></span> <a title="Permalink" class="permalink" href="cha-ha-maintenance.html#sec-ha-maint-mode-node">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    To put a node into maintenance mode on the crm shell, use the following command:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm</code> node maintenance <em class="replaceable">NODENAME</em></pre></div><p>
    To put the node back into normal mode after your maintenance work is done, use the following command:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm</code> node ready <em class="replaceable">NODENAME</em></pre></div><div class="procedure" id="pro-ha-maint-mode-nodes-hawk2" data-id-title="Putting a Node into Maintenance Mode with Hawk2"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 23.3: </span><span class="title-name">Putting a Node into Maintenance Mode with Hawk2 </span></span><a title="Permalink" class="permalink" href="cha-ha-maintenance.html#pro-ha-maint-mode-nodes-hawk2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Start a Web browser and log in to the cluster as described in
     <a class="xref" href="cha-conf-hawk2.html#sec-conf-hawk2-login" title="6.2. Logging In">Section 6.2, “Logging In”</a>.
    </p></li><li class="step"><p>
     In the left navigation bar, select <span class="guimenu">Cluster Status</span>.
    </p></li><li class="step"><p>
     In one of the individual nodes' views, click the wrench icon next to the
     node and select <span class="guimenu">Maintenance</span>.
    </p></li><li class="step"><p>
      After you have finished your maintenance task, click the wrench icon next to the node
     and select <span class="guimenu">Ready</span>.
    </p></li></ol></div></div></section><section class="sect1" id="sec-ha-maint-node-standby" data-id-title="Putting a Node into Standby Mode"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.6 </span><span class="title-name">Putting a Node into Standby Mode</span></span> <a title="Permalink" class="permalink" href="cha-ha-maintenance.html#sec-ha-maint-node-standby">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    To put a node into standby mode on the crm shell, use the following command:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>crm node standby <em class="replaceable">NODENAME</em></pre></div><p>
    To bring the node back online after your maintenance work is done, use the following command:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>crm node online <em class="replaceable">NODENAME</em></pre></div><div class="procedure" id="pro-ha-maint-node-standby-hawk2" data-id-title="Putting a Node into Standby Mode with Hawk2"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 23.4: </span><span class="title-name">Putting a Node into Standby Mode with Hawk2 </span></span><a title="Permalink" class="permalink" href="cha-ha-maintenance.html#pro-ha-maint-node-standby-hawk2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Start a Web browser and log in to the cluster as described in
     <a class="xref" href="cha-conf-hawk2.html#sec-conf-hawk2-login" title="6.2. Logging In">Section 6.2, “Logging In”</a>.
    </p></li><li class="step"><p>
     In the left navigation bar, select <span class="guimenu">Cluster Status</span>.
    </p></li><li class="step"><p>
     In one of the individual nodes' views, click the wrench icon next to the
     node and select <span class="guimenu">Standby</span>.
    </p></li><li class="step"><p>
     Finish the maintenance task for the node.
    </p></li><li class="step"><p>
     To deactivate the standby mode, click the wrench icon next to the node
     and select <span class="guimenu">Ready</span>.
    </p></li></ol></div></div></section><section class="sect1" id="sec-ha-maint-mode-rsc" data-id-title="Putting a Resource into Maintenance Mode"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.7 </span><span class="title-name">Putting a Resource into Maintenance Mode</span></span> <a title="Permalink" class="permalink" href="cha-ha-maintenance.html#sec-ha-maint-mode-rsc">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    To put a resource into maintenance mode on the crm shell, use the following command:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm</code> resource maintenance <em class="replaceable">RESOURCE_ID</em> true</pre></div><p>
    To put the resource back into normal mode after your maintenance work is done, use the following command:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm</code> resource maintenance <em class="replaceable">RESOURCE_ID</em> false</pre></div><div class="procedure" id="pro-ha-maint-mode-rsc-hawk2" data-id-title="Putting a Resource into Maintenance Mode with Hawk2"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 23.5: </span><span class="title-name">Putting a Resource into Maintenance Mode with Hawk2 </span></span><a title="Permalink" class="permalink" href="cha-ha-maintenance.html#pro-ha-maint-mode-rsc-hawk2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Start a Web browser and log in to the cluster as described in
     <a class="xref" href="cha-conf-hawk2.html#sec-conf-hawk2-login" title="6.2. Logging In">Section 6.2, “Logging In”</a>.
    </p></li><li class="step"><p>
     In the left navigation bar, select <span class="guimenu">Resources</span>.
    </p></li><li class="step"><p>
     Select the resource you want to put in maintenance mode or unmanaged mode,
     click the wrench icon next to the resource and select <span class="guimenu">Edit
     Resource</span>.
    </p></li><li class="step"><p>
     Open the <span class="guimenu">Meta Attributes</span> category.
    </p></li><li class="step"><p>
     From the empty drop-down box, select the <span class="guimenu">maintenance</span>
     attribute and click the plus icon to add it.
    </p></li><li class="step"><p>
     Activate the check box next to <code class="literal">maintenance</code> to set the
     maintenance attribute to <code class="literal">yes</code>.
    </p></li><li class="step"><p>
     Confirm your changes.
    </p></li><li class="step"><p>
     After you have finished the maintenance task for that resource, deactivate
     the check box next to the <code class="literal">maintenance</code> attribute for
     that resource.
    </p><p>
     From this point on, the resource will be managed by the High Availability software
     again.
    </p></li></ol></div></div></section><section class="sect1" id="sec-ha-maint-rsc-unmanaged" data-id-title="Putting a Resource into Unmanaged Mode"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.8 </span><span class="title-name">Putting a Resource into Unmanaged Mode</span></span> <a title="Permalink" class="permalink" href="cha-ha-maintenance.html#sec-ha-maint-rsc-unmanaged">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    To put a resource into unmanaged mode on the crm shell, use the following command:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm</code> resource unmanage <em class="replaceable">RESOURCE_ID</em></pre></div><p>
    To put it into managed mode again after your maintenance work is done, use the following command:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm</code> resource manage <em class="replaceable">RESOURCE_ID</em></pre></div><div class="procedure" id="pro-ha-maint-rsc-unmanaged-hawk2" data-id-title="Putting a Resource into Unmanaged Mode with Hawk2"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 23.6: </span><span class="title-name">Putting a Resource into Unmanaged Mode with Hawk2 </span></span><a title="Permalink" class="permalink" href="cha-ha-maintenance.html#pro-ha-maint-rsc-unmanaged-hawk2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Start a Web browser and log in to the cluster as described in
     <a class="xref" href="cha-conf-hawk2.html#sec-conf-hawk2-login" title="6.2. Logging In">Section 6.2, “Logging In”</a>.
    </p></li><li class="step"><p>
     From the left navigation bar, select <span class="guimenu">Status</span> and go to
     the <span class="guimenu">Resources</span> list.
    </p></li><li class="step"><p>
     In the <span class="guimenu">Operations</span> column, click the arrow down icon
     next to the resource you want to modify and select
     <span class="guimenu">Edit</span>.
    </p><p>
     The resource configuration screen opens.
    </p></li><li class="step"><p>
     Below <span class="guimenu">Meta Attributes</span>, select the
     <span class="guimenu">is-managed</span> entry from the empty drop-down box.
    </p></li><li class="step"><p>
     Set its value to <code class="literal">No</code> and click <span class="guimenu">Apply</span>.
    </p></li><li class="step"><p>
     After you have finished your maintenance task, set
     <span class="guimenu">is-managed</span> to <code class="literal">Yes</code> (which is the
     default value) and apply your changes.
    </p><p>
     From this point on, the resource will be managed by the High Availability software
     again.
    </p></li></ol></div></div></section><section class="sect1" id="sec-ha-maint-shutdown-node-maint-mode" data-id-title="Rebooting a Cluster Node While In Maintenance Mode"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">23.9 </span><span class="title-name">Rebooting a Cluster Node While In Maintenance Mode</span></span> <a title="Permalink" class="permalink" href="cha-ha-maintenance.html#sec-ha-maint-shutdown-node-maint-mode">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP5/xml/ha_maintenance.xml" title="Edit source document"> </a></div></div></div></div></div><div id="id-1.3.6.3.11.2" data-id-title="Implications" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Implications</div><p>
       If the cluster or a node is in maintenance mode, you can stop or restart cluster
       resources at will—the High Availability software will not attempt to restart them. If
       you stop the Pacemaker service on a node, all daemons and processes
       (originally started as Pacemaker-managed cluster resources) will continue
       to run.
      </p><p>
       If you attempt to start Pacemaker services on a node while the cluster or
       node is in maintenance mode, Pacemaker will initiate a single one-shot monitor
       operation (a <span class="quote">“<span class="quote">probe</span>”</span>) for every resource to evaluate which
       resources are currently running on that node. However, it will take no
       further action other than determining the resources' status.
      </p></div><div class="procedure"><div class="procedure-contents"><p>
    If you want to take down a node while either the cluster or the node is in
    <code class="literal">maintenance mode</code>, proceed as follows:
    </p><ol class="procedure" type="1"><li class="step"><p>
     On the node you want to reboot or shut down, log in as <code class="systemitem">root</code> or
     equivalent.
    </p></li><li class="step"><p>
     Check if you have resources of the type <code class="literal">ocf:pacemaker:controld</code>
     or any dependencies on this type of resource. Resources of the type
     <code class="literal">ocf:pacemaker:controld</code> are DLM resources.
    </p><ol type="a" class="substeps"><li class="step"><p>
       If yes, explicitly stop the DLM resources and any resources
       depending on them:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt custom">crm(live)resource# </code>stop <em class="replaceable">RESOURCE_ID</em></pre></div><p>
       The reason is that stopping Pacemaker also stops the Corosync service, on
       whose membership and messaging services DLM depends. If Corosync stops,
       the DLM resource will assume a split brain scenario and trigger a fencing
       operation.
      </p></li><li class="step"><p>
        If no, continue with <a class="xref" href="cha-ha-maintenance.html#step-stop-pcmkr-service" title="Step 3">Step 3</a>.
       </p></li></ol></li><li class="step" id="step-stop-pcmkr-service"><p>
     Stop the Pacemaker service on that node:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>systemctl stop pacemaker.service</pre></div></li><li class="step"><p>
     Shut down or reboot the node.
    </p></li></ol></div></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="part-maintenance.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Part IV </span>Maintenance and Upgrade</span></a> </div><div><a class="pagination-link next" href="cha-ha-migration.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 24 </span>Upgrading Your Cluster and Updating Software Packages</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-ha-maintenance.html#sec-ha-maint-shutdown-node"><span class="title-number">23.1 </span><span class="title-name">Implications of Taking Down a Cluster Node</span></a></span></li><li><span class="sect1"><a href="cha-ha-maintenance.html#sec-ha-maint-overview"><span class="title-number">23.2 </span><span class="title-name">Different Options for Maintenance Tasks</span></a></span></li><li><span class="sect1"><a href="cha-ha-maintenance.html#sec-ha-maint-outline"><span class="title-number">23.3 </span><span class="title-name">Preparing and Finishing Maintenance Work</span></a></span></li><li><span class="sect1"><a href="cha-ha-maintenance.html#sec-ha-maint-mode-cluster"><span class="title-number">23.4 </span><span class="title-name">Putting the Cluster into Maintenance Mode</span></a></span></li><li><span class="sect1"><a href="cha-ha-maintenance.html#sec-ha-maint-mode-node"><span class="title-number">23.5 </span><span class="title-name">Putting a Node into Maintenance Mode</span></a></span></li><li><span class="sect1"><a href="cha-ha-maintenance.html#sec-ha-maint-node-standby"><span class="title-number">23.6 </span><span class="title-name">Putting a Node into Standby Mode</span></a></span></li><li><span class="sect1"><a href="cha-ha-maintenance.html#sec-ha-maint-mode-rsc"><span class="title-number">23.7 </span><span class="title-name">Putting a Resource into Maintenance Mode</span></a></span></li><li><span class="sect1"><a href="cha-ha-maintenance.html#sec-ha-maint-rsc-unmanaged"><span class="title-number">23.8 </span><span class="title-name">Putting a Resource into Unmanaged Mode</span></a></span></li><li><span class="sect1"><a href="cha-ha-maintenance.html#sec-ha-maint-shutdown-node-maint-mode"><span class="title-number">23.9 </span><span class="title-name">Rebooting a Cluster Node While In Maintenance Mode</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>