<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLE HA 12 SP4 | Administration Guide | Cluster Multi-device (Cluster MD)</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Cluster Multi-device (Cluster MD) | SLE HA 12 SP4"/>
<meta name="description" content="The cluster multi-device (Cluster MD) is a software ba…"/>
<meta name="product-name" content="SUSE Linux Enterprise High Availability"/>
<meta name="product-number" content="12 SP4"/>
<meta name="book-title" content="Administration Guide"/>
<meta name="chapter-title" content="Chapter 20. Cluster Multi-device (Cluster MD)"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Linux Enterprise High Availability Extension 12 SP4"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Cluster Multi-device (Cluster MD) | SLE HA 12 SP4"/>
<meta property="og:description" content="The cluster multi-device (Cluster MD) is a software based RAID storage solution for a cluster. Cluster MD provides the redun…"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Cluster Multi-device (Cluster MD) | SLE HA 12 SP4"/>
<meta name="twitter:description" content="The cluster multi-device (Cluster MD) is a software based RAID storage solution for a cluster. Cluster MD provides the redun…"/>
<link rel="prev" href="cha-ha-clvm.html" title="Chapter 19. Cluster Logical Volume Manager (cLVM)"/><link rel="next" href="cha-ha-samba.html" title="Chapter 21. Samba Clustering"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"> </script><script src="static/js/script.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP4/xml/ha_cluster_md.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Administration Guide</a><span> / </span><a class="crumb" href="part-storage.html">Storage and Data Replication</a><span> / </span><a class="crumb" href="cha-ha-cluster-md.html">Cluster Multi-device (Cluster MD)</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Administration Guide</div><ol><li><a href="pre-ha.html" class=" "><span class="title-number"> </span><span class="title-name">About This Guide</span></a></li><li><a href="part-install.html" class="has-children "><span class="title-number">I </span><span class="title-name">Installation and Setup</span></a><ol><li><a href="cha-ha-concepts.html" class=" "><span class="title-number">1 </span><span class="title-name">Product Overview</span></a></li><li><a href="cha-ha-requirements.html" class=" "><span class="title-number">2 </span><span class="title-name">System Requirements and Recommendations</span></a></li><li><a href="cha-ha-install.html" class=" "><span class="title-number">3 </span><span class="title-name">Installing SUSE Linux Enterprise High Availability</span></a></li><li><a href="cha-ha-setup.html" class=" "><span class="title-number">4 </span><span class="title-name">Using the YaST Cluster Module</span></a></li></ol></li><li><a href="part-config.html" class="has-children "><span class="title-number">II </span><span class="title-name">Configuration and Administration</span></a><ol><li><a href="cha-ha-config-basics.html" class=" "><span class="title-number">5 </span><span class="title-name">Configuration and Administration Basics</span></a></li><li><a href="cha-conf-hawk2.html" class=" "><span class="title-number">6 </span><span class="title-name">Configuring and Managing Cluster Resources with Hawk2</span></a></li><li><a href="cha-ha-manual-config.html" class=" "><span class="title-number">7 </span><span class="title-name">Configuring and Managing Cluster Resources (Command Line)</span></a></li><li><a href="cha-ha-agents.html" class=" "><span class="title-number">8 </span><span class="title-name">Adding or Modifying Resource Agents</span></a></li><li><a href="cha-ha-fencing.html" class=" "><span class="title-number">9 </span><span class="title-name">Fencing and STONITH</span></a></li><li><a href="cha-ha-storage-protect.html" class=" "><span class="title-number">10 </span><span class="title-name">Storage Protection and SBD</span></a></li><li><a href="cha-ha-acl.html" class=" "><span class="title-number">11 </span><span class="title-name">Access Control Lists</span></a></li><li><a href="cha-ha-netbonding.html" class=" "><span class="title-number">12 </span><span class="title-name">Network Device Bonding</span></a></li><li><a href="cha-ha-lb.html" class=" "><span class="title-number">13 </span><span class="title-name">Load Balancing</span></a></li><li><a href="cha-ha-geo.html" class=" "><span class="title-number">14 </span><span class="title-name">Geo Clusters (Multi-Site Clusters)</span></a></li></ol></li><li class="active"><a href="part-storage.html" class="has-children you-are-here"><span class="title-number">III </span><span class="title-name">Storage and Data Replication</span></a><ol><li><a href="cha-ha-storage-dlm.html" class=" "><span class="title-number">15 </span><span class="title-name">Distributed Lock Manager (DLM)</span></a></li><li><a href="cha-ha-ocfs2.html" class=" "><span class="title-number">16 </span><span class="title-name">OCFS2</span></a></li><li><a href="cha-ha-gfs2.html" class=" "><span class="title-number">17 </span><span class="title-name">GFS2</span></a></li><li><a href="cha-ha-drbd.html" class=" "><span class="title-number">18 </span><span class="title-name">DRBD</span></a></li><li><a href="cha-ha-clvm.html" class=" "><span class="title-number">19 </span><span class="title-name">Cluster Logical Volume Manager (cLVM)</span></a></li><li><a href="cha-ha-cluster-md.html" class=" you-are-here"><span class="title-number">20 </span><span class="title-name">Cluster Multi-device (Cluster MD)</span></a></li><li><a href="cha-ha-samba.html" class=" "><span class="title-number">21 </span><span class="title-name">Samba Clustering</span></a></li><li><a href="cha-ha-rear.html" class=" "><span class="title-number">22 </span><span class="title-name">Disaster Recovery with Relax-and-Recover (ReaR)</span></a></li></ol></li><li><a href="part-maintenance.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Maintenance and Upgrade</span></a><ol><li><a href="cha-ha-maintenance.html" class=" "><span class="title-number">23 </span><span class="title-name">Executing Maintenance Tasks</span></a></li><li><a href="cha-ha-migration.html" class=" "><span class="title-number">24 </span><span class="title-name">Upgrading Your Cluster and Updating Software Packages</span></a></li></ol></li><li><a href="part-appendix.html" class="has-children "><span class="title-number">V </span><span class="title-name">Appendix</span></a><ol><li><a href="app-ha-troubleshooting.html" class=" "><span class="title-number">A </span><span class="title-name">Troubleshooting</span></a></li><li><a href="app-naming.html" class=" "><span class="title-number">B </span><span class="title-name">Naming Conventions</span></a></li><li><a href="app-ha-management.html" class=" "><span class="title-number">C </span><span class="title-name">Cluster Management Tools (Command Line)</span></a></li><li><a href="app-crmreport-nonroot.html" class=" "><span class="title-number">D </span><span class="title-name">Running Cluster Reports Without <code class="systemitem">root</code> Access</span></a></li><li><a href="app-ha-docupdates.html" class=" "><span class="title-number">E </span><span class="title-name">Documentation Updates</span></a></li></ol></li><li><a href="gl-heartb.html" class=" "><span class="title-number"> </span><span class="title-name">Glossary</span></a></li><li><a href="bk01apf.html" class=" "><span class="title-number">F </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-ha-cluster-md" data-id-title="Cluster Multi-device (Cluster MD)"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname">SUSE Linux Enterprise High Availability</span> <span class="productnumber">12 SP4</span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">20 </span><span class="title-name">Cluster Multi-device (Cluster MD)</span></span> <a title="Permalink" class="permalink" href="cha-ha-cluster-md.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP4/xml/ha_cluster_md.xml" title="Edit source document"> </a></div></div></div><div><div class="abstract"><p>The cluster multi-device (Cluster MD) is a software based RAID
   storage solution for a cluster. Cluster MD provides the redundancy of
   RAID1 mirroring to the cluster. Currently, only RAID1 is supported now.
   This chapter shows you how to create and use Cluster MD.
   </p></div></div></div></div><section class="sect1" id="sec-ha-cluster-md-overview" data-id-title="Conceptual Overview"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">20.1 </span><span class="title-name">Conceptual Overview</span></span> <a title="Permalink" class="permalink" href="cha-ha-cluster-md.html#sec-ha-cluster-md-overview">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP4/xml/ha_cluster_md.xml" title="Edit source document"> </a></div></div></div></div></div><p>The Cluster MD provides support for use of RAID1 across a cluster
   environment. The disks or devices used by Cluster MD are accessed by each node.
   If one device of the Cluster MD fails, it can be
   replaced at runtime by another device and it is re-synced to provide
   the same amount of redundancy. The Cluster MD requires Corosync
   and Distributed Lock Manager (DLM) for co-ordination and messaging.
  </p><p>
   A Cluster MD device is not automatically started on boot like the rest of
   the regular MD devices. A clustered device needs to be started using
   resource agents to ensure the DLM resource has been started.
  </p></section><section class="sect1" id="sec-ha-cluster-md-create" data-id-title="Creating a Clustered MD RAID Device"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">20.2 </span><span class="title-name">Creating a Clustered MD RAID Device</span></span> <a title="Permalink" class="permalink" href="cha-ha-cluster-md.html#sec-ha-cluster-md-create">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP4/xml/ha_cluster_md.xml" title="Edit source document"> </a></div></div></div></div></div><div class="itemizedlist"><div class="title-container"><div class="itemizedlist-title-wrap"><div class="itemizedlist-title"><span class="title-number-name"><span class="title-name">Requirements </span></span><a title="Permalink" class="permalink" href="cha-ha-cluster-md.html#id-1.3.5.8.4.2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP4/xml/ha_cluster_md.xml" title="Edit source document"> </a></div></div><ul class="itemizedlist"><li class="listitem"><p>A running cluster with pacemaker.</p></li><li class="listitem"><p>A resource agent for DLM (see <a class="xref" href="cha-ha-storage-dlm.html#pro-dlm-resources" title="Configuring a Base Group for DLM">Procedure 15.1, “Configuring a Base Group for DLM”</a> on how to configure DLM).</p></li><li class="listitem"><p>At least two shared disk devices. You can use an additional device as
    a spare which will fail over automatically in case of device failure.</p></li><li class="listitem"><p>An installed package <span class="package">cluster-md-kmp-default</span>.</p></li></ul></div><p>
   This procedure uses <code class="literal">/dev/sd<em class="replaceable">X</em></code>
   device names as examples. For better stability, use persistent device names
   such as <code class="literal">/dev/disk/by-id/<em class="replaceable">DEVICE_ID</em></code>.
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Make sure the DLM resource is up and running on every node of the cluster
     and check the resource status with the command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm_resource</code> -r dlm -W</pre></div></li><li class="step"><p>Create the Cluster MD device:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
       If you do not have an existing normal RAID device, create the Cluster MD
       device on the node running the DLM resource with the following command:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">mdadm</code> --create /dev/md0 --bitmap=clustered \
   --metadata=1.2 --raid-devices=2 --level=mirror /dev/sda /dev/sdb</pre></div><p>
       As Cluster MD only works with version 1.2 of the metadata, it is
       recommended to specify the version using the <code class="option">--metadata</code>
       option.
       For other useful options, refer to the man page of
        <code class="command">mdadm</code>. Monitor the progress of the re-sync in
        <code class="filename">/proc/mdstat</code>. </p></li><li class="listitem"><p>
       If you already have an existing normal RAID, first clear the existing
       bitmap and then create the clustered bitmap:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">mdadm</code> --grow /dev/md<em class="replaceable">X</em> --bitmap=none
<code class="prompt root"># </code><code class="command">mdadm</code> --grow /dev/md<em class="replaceable">X</em> --bitmap=clustered</pre></div></li><li class="listitem"><p>Optionally, to create a Cluster MD device with a
       spare device for automatic failover, run the following command on one
       cluster node:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">mdadm</code> --create /dev/md0 --bitmap=clustered --raid-devices=2 \
      --level=mirror --spare-devices=1 /dev/sda /dev/sdb /dev/sdc --metadata=1.2</pre></div></li></ul></div></li><li class="step"><p>Get the UUID and the related md path:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">mdadm</code> --detail --scan</pre></div><p>The UUID must match the UUID stored in the superblock. For details on
      the UUID, refer to the <code class="command">mdadm.conf</code> man page.
     </p></li><li class="step"><p>Open <code class="filename">/etc/mdadm.conf</code> and add the md device name
     and the devices associated with it. Use the UUID from the previous step: </p><div class="verbatim-wrap"><pre class="screen">DEVICE /dev/sda /dev/sdb
ARRAY /dev/md0 UUID=1d70f103:49740ef1:af2afce5:fcf6a489</pre></div></li><li class="step"><p>Open Csync2's configuration file <code class="filename">/etc/csync2/csync2.cfg</code>
     and add <code class="filename">/etc/mdadm.conf</code>:</p><div class="verbatim-wrap"><pre class="screen">group ha_group
{
   # ... list of files pruned ...
   include /etc/mdadm.conf
}</pre></div></li></ol></div></div></section><section class="sect1" id="sec-ha-cluster-md-ra" data-id-title="Configuring a Resource Agent"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">20.3 </span><span class="title-name">Configuring a Resource Agent</span></span> <a title="Permalink" class="permalink" href="cha-ha-cluster-md.html#sec-ha-cluster-md-ra">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP4/xml/ha_cluster_md.xml" title="Edit source document"> </a></div></div></div></div></div><p>Configure a CRM resource as follows:</p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>Create a <code class="systemitem">Raid1</code> primitive:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt custom">crm(live)configure# </code><code class="command">primitive</code> raider Raid1 \
  params raidconf="/etc/mdadm.conf" raiddev=/dev/md0 \
  force_clones=true \
  op monitor timeout=20s interval=10 \
  op start timeout=20s interval=0 \
  op stop timeout=20s interval=0</pre></div></li><li class="step"><p>Add the <code class="systemitem">raider</code> resource to the base group for storage that you have created for
     DLM:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt custom">crm(live)configure# </code><code class="command">modgroup</code> g-storage add raider</pre></div><p>The <code class="command">add</code> sub-command appends the new group
     member by default. </p><p>
    If not already done, clone the <code class="literal">g-storage</code> group so that it runs on all nodes:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt custom">crm(live)configure# </code><code class="command">clone</code> cl-storage g-storage \
    meta interleave=true target-role=Started</pre></div></li><li class="step"><p>Review your changes with
     <code class="command">show</code>.</p></li><li class="step"><p>If everything seems correct, submit your changes with
     <code class="command">commit</code>.</p></li></ol></div></div></section><section class="sect1" id="sec-ha-cluster-md-dev-add" data-id-title="Adding a Device"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">20.4 </span><span class="title-name">Adding a Device</span></span> <a title="Permalink" class="permalink" href="cha-ha-cluster-md.html#sec-ha-cluster-md-dev-add">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP4/xml/ha_cluster_md.xml" title="Edit source document"> </a></div></div></div></div></div><p>To add a device to an existing, active Cluster MD device, first ensure that
   the device is <span class="quote">“<span class="quote">visible</span>”</span> on each node with the command
   <code class="command">cat /proc/mdstat</code>.
   If the device is not visible, the command will fail.
  </p><p>
   Use the following command on one cluster node:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">mdadm</code> --manage /dev/md0 --add /dev/sdc</pre></div><p>The behavior of the new device added depends on the state of the Cluster
   MD device:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>If only one of the mirrored devices is active, the new device becomes
     the second device of the mirrored devices and a recovery is initiated.</p></li><li class="listitem"><p>If both devices of the Cluster MD device are active, the new
     added device becomes a spare device.</p></li></ul></div></section><section class="sect1" id="sec-ha-cluster-md-dev-readd" data-id-title="Re-adding a Temporarily Failed Device"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">20.5 </span><span class="title-name">Re-adding a Temporarily Failed Device</span></span> <a title="Permalink" class="permalink" href="cha-ha-cluster-md.html#sec-ha-cluster-md-dev-readd">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP4/xml/ha_cluster_md.xml" title="Edit source document"> </a></div></div></div></div></div><p>Quite often the failures are transient and limited to a single node. If
   any of the nodes encounters a failure during an I/O operation, the device will
   be marked as failed for the entire cluster.
  </p><p> This could happen, for example, because of a cable failure on one of the
   nodes. After correcting the problem, you can re-add the device. Only the
   outdated parts will be synchronized as opposed to synchronizing the entire device by
   adding a new one.
  </p><p>
   To re-add the device, run the following command on one cluster node: </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">mdadm</code> --manage /dev/md0 --re-add /dev/sdb</pre></div></section><section class="sect1" id="sec-ha-cluster-md-dev-remove" data-id-title="Removing a Device"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">20.6 </span><span class="title-name">Removing a Device</span></span> <a title="Permalink" class="permalink" href="cha-ha-cluster-md.html#sec-ha-cluster-md-dev-remove">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP4/xml/ha_cluster_md.xml" title="Edit source document"> </a></div></div></div></div></div><p>Before removing a device at runtime for replacement, do the following:</p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>Make sure the device is failed by introspecting <code class="filename">/proc/mdstat</code>.
    Look for an <code class="literal">(F)</code> before the device.</p></li><li class="step"><p>Run the following command on one cluster node to make a device fail:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">mdadm</code> --manage /dev/md0 --fail /dev/sda</pre></div></li><li class="step"><p>Remove the failed device using the command on one cluster node:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">mdadm</code> --manage /dev/md0 --remove /dev/sda</pre></div></li></ol></div></div></section><section class="sect1" id="sec-ha-cluster-md-convert-raid" data-id-title="Assembling Cluster MD as normal RAID at the disaster recovery site"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">20.7 </span><span class="title-name">Assembling Cluster MD as normal RAID at the disaster recovery site</span></span> <a title="Permalink" class="permalink" href="cha-ha-cluster-md.html#sec-ha-cluster-md-convert-raid">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA12SP4/xml/ha_cluster_md.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   In the event of disaster recovery, you might face the situation that you do not have
   a Pacemaker cluster stack in the infrastructure on the disaster recovery site, but
   applications still need to access the data on the existing Cluster MD disks,
   or from the backups.
  </p><p>
   You can convert a Cluster MD RAID to a normal RAID by using the <code class="option">--assemble</code>
   operation with the <code class="option">-U no-bitmap</code> option to change the metadata
   of the RAID disks accordingly.
   </p><p>
    Find an example below of how to assemble all arrays on the data recovery site:
   </p><div class="verbatim-wrap"><pre class="screen">while read i; do
   NAME=`echo $i | sed 's/.*name=//'|awk '{print $1}'|sed 's/.*://'`
   UUID=`echo $i | sed 's/.*UUID=//'|awk '{print $1}'`
   mdadm -AR "/dev/md/$NAME" -u $UUID -U no-bitmap
   echo "NAME =" $NAME ", UUID =" $UUID ", assembled."
done &lt; &lt;(mdadm -Es)</pre></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-ha-clvm.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 19 </span>Cluster Logical Volume Manager (cLVM)</span></a> </div><div><a class="pagination-link next" href="cha-ha-samba.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 21 </span>Samba Clustering</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-ha-cluster-md.html#sec-ha-cluster-md-overview"><span class="title-number">20.1 </span><span class="title-name">Conceptual Overview</span></a></span></li><li><span class="sect1"><a href="cha-ha-cluster-md.html#sec-ha-cluster-md-create"><span class="title-number">20.2 </span><span class="title-name">Creating a Clustered MD RAID Device</span></a></span></li><li><span class="sect1"><a href="cha-ha-cluster-md.html#sec-ha-cluster-md-ra"><span class="title-number">20.3 </span><span class="title-name">Configuring a Resource Agent</span></a></span></li><li><span class="sect1"><a href="cha-ha-cluster-md.html#sec-ha-cluster-md-dev-add"><span class="title-number">20.4 </span><span class="title-name">Adding a Device</span></a></span></li><li><span class="sect1"><a href="cha-ha-cluster-md.html#sec-ha-cluster-md-dev-readd"><span class="title-number">20.5 </span><span class="title-name">Re-adding a Temporarily Failed Device</span></a></span></li><li><span class="sect1"><a href="cha-ha-cluster-md.html#sec-ha-cluster-md-dev-remove"><span class="title-number">20.6 </span><span class="title-name">Removing a Device</span></a></span></li><li><span class="sect1"><a href="cha-ha-cluster-md.html#sec-ha-cluster-md-convert-raid"><span class="title-number">20.7 </span><span class="title-name">Assembling Cluster MD as normal RAID at the disaster recovery site</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2023</span></div></div></footer></body></html>