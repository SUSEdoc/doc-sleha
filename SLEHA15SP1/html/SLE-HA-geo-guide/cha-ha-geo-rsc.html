<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLE HA 15 SP1 | Geo Clustering Guide | Configuring Cluster Resources and Constraints</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Configuring Cluster Resources and Constraints | SLE HA 15 S…"/>
<meta name="description" content="Apart from the resources and constraints that you need…"/>
<meta name="product-name" content="SUSE Linux Enterprise High Availability"/>
<meta name="product-number" content="15 SP1"/>
<meta name="book-title" content="Geo Clustering Guide"/>
<meta name="chapter-title" content="Chapter 6. Configuring Cluster Resources and Constraints"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Linux Enterprise High Availability Extension 15 SP1"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Configuring Cluster Resources and Constraints | SLE HA…"/>
<meta property="og:description" content="Apart from the resources and constraints that you need to define for your specific cluster setup, Geo clusters require addit…"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Configuring Cluster Resources and Constraints | SLE HA…"/>
<meta name="twitter:description" content="Apart from the resources and constraints that you need to define for your specific cluster setup, Geo clusters require addit…"/>
<link rel="prev" href="cha-ha-geo-sync.html" title="Chapter 5. Synchronizing Configuration Files Across All Sites and Arbitrators"/><link rel="next" href="cha-ha-geo-ip-relocation.html" title="Chapter 7. Setting Up IP Relocation via DNS Update"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"> </script><script src="static/js/script.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP1/xml/geo_resources_i.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Geo Clustering Guide</a><span> / </span><a class="crumb" href="cha-ha-geo-rsc.html">Configuring Cluster Resources and Constraints</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Geo Clustering Guide</div><ol><li><a href="cha-ha-geo-challenges.html" class=" "><span class="title-number">1 </span><span class="title-name">Challenges for Geo Clusters</span></a></li><li><a href="cha-ha-geo-concept.html" class=" "><span class="title-number">2 </span><span class="title-name">Conceptual Overview</span></a></li><li><a href="cha-ha-geo-req.html" class=" "><span class="title-number">3 </span><span class="title-name">Requirements</span></a></li><li><a href="cha-ha-geo-booth.html" class=" "><span class="title-number">4 </span><span class="title-name">Setting Up the Booth Services</span></a></li><li><a href="cha-ha-geo-sync.html" class=" "><span class="title-number">5 </span><span class="title-name">Synchronizing Configuration Files Across All Sites and Arbitrators</span></a></li><li><a href="cha-ha-geo-rsc.html" class=" you-are-here"><span class="title-number">6 </span><span class="title-name">Configuring Cluster Resources and Constraints</span></a></li><li><a href="cha-ha-geo-ip-relocation.html" class=" "><span class="title-number">7 </span><span class="title-name">Setting Up IP Relocation via DNS Update</span></a></li><li><a href="cha-ha-geo-manage.html" class=" "><span class="title-number">8 </span><span class="title-name">Managing Geo Clusters</span></a></li><li><a href="cha-ha-geo-trouble.html" class=" "><span class="title-number">9 </span><span class="title-name">Troubleshooting</span></a></li><li><a href="cha-ha-geo-upgrade.html" class=" "><span class="title-number">10 </span><span class="title-name">Upgrading to the Latest Product Version</span></a></li><li><a href="sec-ha-geo-more.html" class=" "><span class="title-number">11 </span><span class="title-name">For More Information</span></a></li><li><a href="bk03apa.html" class=" "><span class="title-number">A </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-ha-geo-rsc" data-id-title="Configuring Cluster Resources and Constraints"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname">SUSE Linux Enterprise High Availability</span> <span class="productnumber">15 SP1</span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">6 </span><span class="title-name">Configuring Cluster Resources and Constraints</span></span> <a title="Permalink" class="permalink" href="cha-ha-geo-rsc.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP1/xml/geo_resources_i.xml" title="Edit source document"> </a></div></div></div></div></div><p>
  Apart from the resources and constraints that you need to define for your
  specific cluster setup, Geo clusters require additional resources and
  constraints as described below. You can either configure them with the
  crm shell (crmsh) as demonstrated in the examples below, or with
  Hawk2.
 </p><p>
  This chapter focuses on tasks specific to Geo clusters. For an introduction
  to your preferred cluster management tool and general instructions on how to
  configure resources and constraints with it, refer to one of the following
  chapters:
 </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
    <span class="intraxref">Book “Administration Guide”, Chapter 5 “Configuration and Administration Basics”, Section 5.4 “Introduction to Hawk2”</span>
   </p></li><li class="listitem"><p>
    <span class="intraxref">Book “Administration Guide”, Chapter 5 “Configuration and Administration Basics”, Section 5.5 “Introduction to crmsh”</span>
   </p></li></ul></div><p>
  If you have set up your Geo cluster with the bootstrap scripts, the cluster
  resources needed for booth have been configured already (including a resource
  group for boothd). In this case, you can skip
  <a class="xref" href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-boothd" title="6.2. Configuring a Resource Group for boothd">Section 6.2</a> and only
  need to execute the remaining steps below to complete the cluster resource
  configuration.
 </p><p>
  If you are setting up your Geo cluster manually, you need to execute all of
  the following steps:
 </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>

    <a class="xref" href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-ticket-dep" title="6.1. Configuring Ticket Dependencies of Resources">Section 6.1, “Configuring Ticket Dependencies of Resources”</a>
   </p></li><li class="listitem"><p>

    <a class="xref" href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-boothd" title="6.2. Configuring a Resource Group for boothd">Section 6.2, “Configuring a Resource Group for <code class="systemitem">boothd</code>”</a>
   </p></li><li class="listitem"><p>

    <a class="xref" href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-order" title="6.3. Adding an Order Constraint">Section 6.3, “Adding an Order Constraint”</a>
   </p></li><li class="listitem"><p>

    <a class="xref" href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-sync-cib" title="6.4. Transferring the Resource Configuration to Other Cluster Sites">Section 6.4, “Transferring the Resource Configuration to Other Cluster Sites”</a>
   </p></li></ul></div><div id="id-1.5.8.8" data-id-title="No CIB Synchronization Across Sites" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: No CIB Synchronization Across Sites</div><p>
   The CIB is <span class="emphasis"><em>not</em></span> automatically synchronized across
   cluster sites of a Geo cluster. All resources that must be highly
   available across the Geo cluster need to be configured for each site
   accordingly or need to be transferred to the other site or sites.
  </p><p>
   To simplify transfer, any resources with site-specific parameters can be
   configured in such a way that the parameters' values depend on the name of
   the cluster site where the resource is running (see also
   <a class="xref" href="cha-ha-geo-req.html" title="Chapter 3. Requirements">Chapter 3, <em>Requirements</em></a>, <em class="citetitle">Other Requirements and
   Recommendations</em>).
  </p><p>
   After you have configured the resources on one site, you can tag the
   resources that are needed on all cluster sites, export them from the current
   CIB, and import them into the CIB of another cluster site. For details, see
   <a class="xref" href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-sync-cib" title="6.4. Transferring the Resource Configuration to Other Cluster Sites">Section 6.4, “Transferring the Resource Configuration to Other Cluster Sites”</a>.
  </p></div><section class="sect1" id="sec-ha-geo-rsc-ticket-dep" data-id-title="Configuring Ticket Dependencies of Resources"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">6.1 </span><span class="title-name">Configuring Ticket Dependencies of Resources</span></span> <a title="Permalink" class="permalink" href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-ticket-dep">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP1/xml/geo_resources_i.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     For Geo clusters, you can specify which resources depend on a
     certain ticket. Together with this special type of constraint, you can
     set a <code class="literal">loss-policy</code> that defines what should happen to
     the respective resources if the ticket is revoked. The attribute
     <code class="literal">loss-policy</code> can have the following values:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
       <code class="literal">fence</code>: Fence the nodes that are running the
       relevant resources.
      </p></li><li class="listitem"><p>
       <code class="literal">stop</code>: Stop the relevant resources.
      </p></li><li class="listitem"><p>
       <code class="literal">freeze</code>: Do nothing to the relevant resources.
      </p></li><li class="listitem"><p>
       <code class="literal">demote</code>: Demote relevant resources that are running
       in active mode to passive mode.
      </p></li></ul></div><div class="procedure" id="pro-ha-geo-setup-rsc-constraints" data-id-title="Configuring Ticket Dependencies of Resources with crmsh"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 6.1: </span><span class="title-name">Configuring Ticket Dependencies of Resources with crmsh </span></span><a title="Permalink" class="permalink" href="cha-ha-geo-rsc.html#pro-ha-geo-setup-rsc-constraints">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP1/xml/geo_resources_i.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     On one of the nodes of cluster amsterdam, start a shell and log in as
     <code class="systemitem">root</code> or equivalent.

    </p></li><li class="step"><p>
     Enter <code class="command">crm configure</code> to switch to the interactive
     crm shell.
    </p></li><li class="step" id="step-ha-geo-setup-rsc-constraints"><p>
     Configure constraints that define which resources depend on a certain
     ticket. For example, to make a primitive resource <code class="literal">rsc1</code>
     depend on <code class="literal">ticketA</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt custom">crm(live)configure# </code><code class="command">rsc_ticket</code> rsc1-req-ticketA ticketA: \
  rsc1 loss-policy="fence"</pre></div><p>
     In case <code class="literal">ticketA</code> is revoked, the node running the
     resource should be fenced.
    </p></li><li class="step"><p>
     If you want other resources to depend on further tickets, create as many
     constraints as necessary with <code class="command">rsc_ticket</code>.
    </p></li><li class="step"><p>
     Review your changes with <code class="command">show</code>.
    </p></li><li class="step"><p>
     If everything is correct, submit your changes with
     <code class="command">commit</code> and leave the crm live configuration with
     <code class="command">quit</code>.
    </p><p>
     The configuration is saved to the CIB.
    </p></li></ol></div></div></section><section class="sect1" id="sec-ha-geo-rsc-boothd" data-id-title="Configuring a Resource Group for boothd"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">6.2 </span><span class="title-name">Configuring a Resource Group for <code class="systemitem">boothd</code></span></span> <a title="Permalink" class="permalink" href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-boothd">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP1/xml/geo_resources_i.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   If you have set up your Geo cluster with the
   <code class="systemitem">ha-cluster-init</code> bootstrap scripts, you can skip the
   following procedure as the resources and the resource group for boothd have
   already been configured in this case.
  </p><p>
      Each site needs to run one instance of
      <code class="systemitem">boothd</code> that communicates
      with the other booth daemons. The daemon can be started on any node,
      therefore it should be configured as primitive resource. To make the
      <code class="systemitem">boothd</code> resource stay on the same node, if
      possible, add resource stickiness to the configuration. As each daemon
      needs a persistent IP address, configure another primitive with a
      virtual IP address. Group both primitives:</p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     On one of the nodes of cluster <code class="literal">amsterdam</code>, start a
     shell and log in as <code class="systemitem">root</code> or equivalent.
    </p></li><li class="step"><p>
     Enter <code class="command">crm configure</code> to switch to the interactive
     crm shell.
    </p></li><li class="step"><p>
     Enter the following to create both primitive resources and to add them to
     one group, <code class="literal">g-booth</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt custom">crm(live)configure# </code><code class="command">primitive</code> ip-booth ocf:heartbeat:IPaddr2 \
  params iflabel="ha" nic="eth1" cidr_netmask="24"
  params rule #cluster-name eq amsterdam ip="192.168.201.100" \
  params rule #cluster-name eq berlin ip="192.168.202.100"
<code class="prompt custom">crm(live)configure# </code><code class="command">primitive</code> booth-site ocf:pacemaker:booth-site \
  meta resource-stickiness="INFINITY" \
  params config="nfs" op monitor interval="10s"
<code class="prompt custom">crm(live)configure# </code><code class="command">group</code> g-booth ip-booth booth-site</pre></div><p>
     With this configuration, each booth daemon will be available at its
     individual IP address, independent of the node the daemon is running on.
    </p></li><li class="step"><p>
     Review your changes with <code class="command">show</code>.
    </p></li><li class="step"><p>
     If everything is correct, submit your changes with
     <code class="command">commit</code> and leave the crm live configuration with
     <code class="command">quit</code>.
    </p><p>
     The configuration is saved to the CIB.
    </p></li></ol></div></div></section><section class="sect1" id="sec-ha-geo-rsc-order" data-id-title="Adding an Order Constraint"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">6.3 </span><span class="title-name">Adding an Order Constraint</span></span> <a title="Permalink" class="permalink" href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-order">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP1/xml/geo_resources_i.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      If a ticket has been granted to a site but all nodes of that site
      should fail to host the <code class="systemitem">boothd</code>
      resource group for any reason, a <span class="quote">“<span class="quote">split-brain</span>”</span> situation
      among the geographically dispersed sites may occur. In that case, no
      <code class="systemitem">boothd</code> instance would be available to safely manage failover of the
      ticket to another site. To avoid a potential concurrency violation of the
      ticket (the ticket is granted to multiple sites simultaneously), add an
      order constraint:
     </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     On one of the nodes of cluster amsterdam, start a shell and log in as
     <code class="systemitem">root</code> or equivalent.
    </p></li><li class="step"><p>
     Enter <code class="command">crm configure</code> to switch to the interactive
     crm shell.
    </p></li><li class="step"><p>
     Create an order constraint, for example:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt custom">crm(live)configure# </code><code class="command">order</code> o-booth-before-rsc1 Mandatory: g-booth rsc1</pre></div><p>
     It defines that <code class="literal">rsc1</code> (which depends on
     <code class="literal">ticketA</code>) can only be started after the
     <code class="literal">g-booth</code> resource group.
    </p></li><li class="step"><p>
     For any other resources that depend on a certain ticket, define further
     order constraints.
    </p></li><li class="step"><p>
     Review your changes with <code class="command">show</code>.
    </p></li><li class="step"><p>
     If everything is correct, submit your changes with
     <code class="command">commit</code> and leave the crm live configuration with
     <code class="command">quit</code>.
    </p><p>
     The configuration is saved to the CIB.
    </p></li></ol></div></div></section><section class="sect1" id="sec-ha-geo-rsc-sync-cib" data-id-title="Transferring the Resource Configuration to Other Cluster Sites"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">6.4 </span><span class="title-name">Transferring the Resource Configuration to Other Cluster Sites</span></span> <a title="Permalink" class="permalink" href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-sync-cib">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP1/xml/geo_resources_i.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   After having completed or changed your resource configuration for one
   cluster site, transfer it to the other sites of your Geo cluster.
  </p><p>
   To simplify the transfer, you can tag any resources that are needed on all
   cluster sites, export them from the current CIB, and import them into the
   CIB of another cluster site. Tagging does not create any colocation or
   ordering relationship between the resources.
  </p><p>
   <a class="xref" href="cha-ha-geo-rsc.html#pro-ha-geo-rsc-sync-cib-export" title="Tagging and Exporting a Resource Configuration">Procedure 6.2, “Tagging and Exporting a Resource Configuration”</a> and
   <a class="xref" href="cha-ha-geo-rsc.html#pro-ha-geo-rsc-sync-cib-import" title="Importing a Tagged Resource Configuration">Procedure 6.3, “Importing a Tagged Resource Configuration”</a> give an example of how
   to do so. They are based on the following prerequisites:
  </p><div class="itemizedlist"><div class="title-container"><div class="itemizedlist-title-wrap"><div class="itemizedlist-title"><span class="title-number-name"><span class="title-name">Prerequisites </span></span><a title="Permalink" class="permalink" href="cha-ha-geo-rsc.html#id-1.5.8.12.5">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP1/xml/geo_resources_i.xml" title="Edit source document"> </a></div></div><ul class="itemizedlist"><li class="listitem"><p>
     You have a Geo cluster with two sites: cluster
     <code class="literal">amsterdam</code> and cluster <code class="literal">berlin</code>.
    </p></li><li class="listitem"><p>
     The cluster names for each site are defined in the respective
     <code class="filename">/etc/corosync/corosync.conf</code> files:
    </p><div class="verbatim-wrap"><pre class="screen">totem {
     [...]
     cluster_name: amsterdam
     }</pre></div><p>
     This can either be done manually (by editing <code class="filename">/etc/corosync/corosync.conf</code>) or with the
     YaST cluster module (by switching to the <span class="guimenu">Communication
     Channels</span> category and defining a <span class="guimenu">Cluster
     Name</span>). Afterward, stop and start the cluster services
     for the changes to take effect:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm</code> cluster restart</pre></div></li><li class="listitem"><p>
     The necessary resources for booth and for all services that should be
     highly available across your Geo cluster have been configured in the CIB
     on site <code class="literal">amsterdam</code>. They will be imported to the CIB on
     site <code class="literal">berlin</code>.
    </p></li></ul></div><div class="procedure" id="pro-ha-geo-rsc-sync-cib-export" data-id-title="Tagging and Exporting a Resource Configuration"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 6.2: </span><span class="title-name">Tagging and Exporting a Resource Configuration </span></span><a title="Permalink" class="permalink" href="cha-ha-geo-rsc.html#pro-ha-geo-rsc-sync-cib-export">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP1/xml/geo_resources_i.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Log in to one of the nodes of cluster <code class="literal">amsterdam</code>.
    </p></li><li class="step"><p>
     Start the cluster with:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm</code> cluster start</pre></div></li><li class="step"><p>
     Enter <code class="command">crm configure</code> to switch to the interactive
     crm shell.
    </p></li><li class="step"><p>
     Review the current CIB configuration:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt custom">crm(live)configure# </code>show</pre></div></li><li class="step"><p>
     Mark the resources and constraints that are needed across the Geo
     cluster with the tag <code class="literal">geo_resources</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt custom">crm(live)configure# </code><code class="command">tag</code> geo_resources: \
  <em class="replaceable">LIST_OF_RESOURCES_and_CONSTRAINTS_FOR_REQUIRED_SERVICES</em> <span class="callout" id="co-geo-rsc-any">1</span>\
  rsc1-req-ticketA ip-booth booth-site g-booth o-booth-before-rsc1 <span class="callout" id="co-geo-rsc-booth">2</span></pre></div><div class="calloutlist"><table style="border: 0; "><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-geo-rsc-any"><span class="callout">1</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
       Any resources and constraints of your specific setup that you need on
       all sites of the Geo cluster (for example, resources for DRBD as
       described in the
       <a class="link" href="https://documentation.suse.com/sbp/all/html/SBP-DRBD/index.html" target="_blank"><em class="citetitle">SUSE Best Practices</em>
       document</a>).
      </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-geo-rsc-booth"><span class="callout">2</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
       Resources and constraints for boothd (primitives, booth resource group,
       ticket dependency, additional order constraint), see
       <a class="xref" href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-ticket-dep" title="6.1. Configuring Ticket Dependencies of Resources">Section 6.1</a>
       to <a class="xref" href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-order" title="6.3. Adding an Order Constraint">Section 6.3</a>.
      </p></td></tr></table></div></li><li class="step"><p>
     Review your changes with <code class="command">show</code>.
    </p></li><li class="step"><p>
     If the configuration is according to your wishes, submit your changes with
     <code class="command">submit</code> and leave the crm live shell with
     <code class="command">quit</code>.
    </p></li><li class="step" id="st-ha-geo-rsc-sync-cib-export-start"><p>
     Export the tagged resources and constraints to a file named
     <code class="filename">exported.cib</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm configure show</code> tag:geo_resources geo_resources &gt; exported.cib</pre></div><p>
     The command <code class="command">crm configure show
     tag:</code><em class="replaceable">TAGNAME</em> shows all resources that
     belong to the tag <em class="replaceable">TAGNAME</em>.
    </p></li></ol></div></div><div class="procedure" id="pro-ha-geo-rsc-sync-cib-import" data-id-title="Importing a Tagged Resource Configuration"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 6.3: </span><span class="title-name">Importing a Tagged Resource Configuration </span></span><a title="Permalink" class="permalink" href="cha-ha-geo-rsc.html#pro-ha-geo-rsc-sync-cib-import">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP1/xml/geo_resources_i.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><p>
    To import the saved configuration file into the CIB of the second cluster
    site, proceed as follows:
   </p><ol class="procedure" type="1"><li class="step"><p>
     Log in to one of the nodes of cluster <code class="literal">berlin</code>.
    </p></li><li class="step"><p>
     Start the cluster with:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm</code> cluster start</pre></div></li><li class="step"><p>
     Copy the file <code class="filename">exported.cib</code> from cluster
     <code class="literal">amsterdam</code> to this node.
     
    </p></li><li class="step"><p>
     Import the tagged resources and constraints from the file
     <code class="filename">exported.cib</code> into the CIB of cluster
     <code class="literal">berlin</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm configure load</code> update <em class="replaceable">PATH_TO_FILE/exported.cib</em></pre></div><p>
     When using the <code class="option">update</code> parameter for the <code class="command">crm
     configure load</code> command, crmsh tries to integrate the contents
     of the file into the current CIB configuration (instead of replacing the
     current CIB with the file contents).
    </p></li><li class="step" id="st-ha-geo-rsc-sync-cib-import-stop"><p>
     View the updated CIB configuration with the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">crm configure show</code></pre></div><p>
     The imported resources and constraints will appear in the CIB.
    </p></li></ol></div></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-ha-geo-sync.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 5 </span>Synchronizing Configuration Files Across All Sites and Arbitrators</span></a> </div><div><a class="pagination-link next" href="cha-ha-geo-ip-relocation.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 7 </span>Setting Up IP Relocation via DNS Update</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-ticket-dep"><span class="title-number">6.1 </span><span class="title-name">Configuring Ticket Dependencies of Resources</span></a></span></li><li><span class="sect1"><a href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-boothd"><span class="title-number">6.2 </span><span class="title-name">Configuring a Resource Group for <code class="systemitem">boothd</code></span></a></span></li><li><span class="sect1"><a href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-order"><span class="title-number">6.3 </span><span class="title-name">Adding an Order Constraint</span></a></span></li><li><span class="sect1"><a href="cha-ha-geo-rsc.html#sec-ha-geo-rsc-sync-cib"><span class="title-number">6.4 </span><span class="title-name">Transferring the Resource Configuration to Other Cluster Sites</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>