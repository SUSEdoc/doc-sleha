<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLE HA 15 SP2 | Administration Guide | Managing Services on Remote Hosts</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Managing Services on Remote Hosts | SLE HA 15 SP2"/>
<meta name="description" content="The possibilities for monitoring and managing services…"/>
<meta name="product-name" content="SUSE Linux Enterprise High Availability"/>
<meta name="product-number" content="15 SP2"/>
<meta name="book-title" content="Administration Guide"/>
<meta name="chapter-title" content="Chapter 9. Managing Services on Remote Hosts"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Linux Enterprise High Availability Extension 15 SP2"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Managing Services on Remote Hosts | SLE HA 15 SP2"/>
<meta property="og:description" content="The possibilities for monitoring and managing services on remote hosts has become increasingly important during the last few…"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Managing Services on Remote Hosts | SLE HA 15 SP2"/>
<meta name="twitter:description" content="The possibilities for monitoring and managing services on remote hosts has become increasingly important during the last few…"/>
<link rel="prev" href="cha-ha-manage-resources.html" title="Chapter 8. Managing Cluster Resources"/><link rel="next" href="cha-ha-agents.html" title="Chapter 10. Adding or Modifying Resource Agents"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"> </script><script src="static/js/script.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP2/xml/ha_remote_hosts.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Administration Guide</a><span> / </span><a class="crumb" href="part-config.html">Configuration and Administration</a><span> / </span><a class="crumb" href="sec-ha-config-basics-remote.html">Managing Services on Remote Hosts</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Administration Guide</div><ol><li><a href="pre-ha.html" class=" "><span class="title-number"> </span><span class="title-name">About This Guide</span></a></li><li><a href="part-install.html" class="has-children "><span class="title-number">I </span><span class="title-name">Installation and Setup</span></a><ol><li><a href="cha-ha-concepts.html" class=" "><span class="title-number">1 </span><span class="title-name">Product Overview</span></a></li><li><a href="cha-ha-requirements.html" class=" "><span class="title-number">2 </span><span class="title-name">System Requirements and Recommendations</span></a></li><li><a href="cha-ha-install.html" class=" "><span class="title-number">3 </span><span class="title-name">Installing SUSE Linux Enterprise High Availability</span></a></li><li><a href="cha-ha-ycluster.html" class=" "><span class="title-number">4 </span><span class="title-name">Using the YaST Cluster Module</span></a></li></ol></li><li class="active"><a href="part-config.html" class="has-children you-are-here"><span class="title-number">II </span><span class="title-name">Configuration and Administration</span></a><ol><li><a href="cha-ha-config-basics.html" class=" "><span class="title-number">5 </span><span class="title-name">Configuration and Administration Basics</span></a></li><li><a href="sec-ha-config-basics-resources.html" class=" "><span class="title-number">6 </span><span class="title-name">Configuring Cluster Resources</span></a></li><li><a href="sec-ha-config-basics-constraints.html" class=" "><span class="title-number">7 </span><span class="title-name">Configuring Resource Constraints</span></a></li><li><a href="cha-ha-manage-resources.html" class=" "><span class="title-number">8 </span><span class="title-name">Managing Cluster Resources</span></a></li><li><a href="sec-ha-config-basics-remote.html" class=" you-are-here"><span class="title-number">9 </span><span class="title-name">Managing Services on Remote Hosts</span></a></li><li><a href="cha-ha-agents.html" class=" "><span class="title-number">10 </span><span class="title-name">Adding or Modifying Resource Agents</span></a></li><li><a href="cha-ha-monitor-clusters.html" class=" "><span class="title-number">11 </span><span class="title-name">Monitoring Clusters</span></a></li><li><a href="cha-ha-fencing.html" class=" "><span class="title-number">12 </span><span class="title-name">Fencing and STONITH</span></a></li><li><a href="cha-ha-storage-protect.html" class=" "><span class="title-number">13 </span><span class="title-name">Storage Protection and SBD</span></a></li><li><a href="cha-ha-qdevice.html" class=" "><span class="title-number">14 </span><span class="title-name">QDevice and QNetd</span></a></li><li><a href="cha-ha-acl.html" class=" "><span class="title-number">15 </span><span class="title-name">Access Control Lists</span></a></li><li><a href="cha-ha-netbonding.html" class=" "><span class="title-number">16 </span><span class="title-name">Network Device Bonding</span></a></li><li><a href="cha-ha-lb.html" class=" "><span class="title-number">17 </span><span class="title-name">Load Balancing</span></a></li><li><a href="cha-ha-geo.html" class=" "><span class="title-number">18 </span><span class="title-name">Geo Clusters (Multi-Site Clusters)</span></a></li></ol></li><li><a href="part-storage.html" class="has-children "><span class="title-number">III </span><span class="title-name">Storage and Data Replication</span></a><ol><li><a href="cha-ha-storage-dlm.html" class=" "><span class="title-number">19 </span><span class="title-name">Distributed Lock Manager (DLM)</span></a></li><li><a href="cha-ha-ocfs2.html" class=" "><span class="title-number">20 </span><span class="title-name">OCFS2</span></a></li><li><a href="cha-ha-gfs2.html" class=" "><span class="title-number">21 </span><span class="title-name">GFS2</span></a></li><li><a href="cha-ha-drbd.html" class=" "><span class="title-number">22 </span><span class="title-name">DRBD</span></a></li><li><a href="cha-ha-clvm.html" class=" "><span class="title-number">23 </span><span class="title-name">Cluster Logical Volume Manager (Cluster LVM)</span></a></li><li><a href="cha-ha-cluster-md.html" class=" "><span class="title-number">24 </span><span class="title-name">Cluster Multi-device (Cluster MD)</span></a></li><li><a href="cha-ha-samba.html" class=" "><span class="title-number">25 </span><span class="title-name">Samba Clustering</span></a></li><li><a href="cha-ha-rear.html" class=" "><span class="title-number">26 </span><span class="title-name">Disaster Recovery with ReaR (Relax-and-Recover)</span></a></li></ol></li><li><a href="part-maintenance.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Maintenance and Upgrade</span></a><ol><li><a href="cha-ha-maintenance.html" class=" "><span class="title-number">27 </span><span class="title-name">Executing Maintenance Tasks</span></a></li><li><a href="cha-ha-migration.html" class=" "><span class="title-number">28 </span><span class="title-name">Upgrading Your Cluster and Updating Software Packages</span></a></li></ol></li><li><a href="part-appendix.html" class="has-children "><span class="title-number">V </span><span class="title-name">Appendix</span></a><ol><li><a href="app-ha-troubleshooting.html" class=" "><span class="title-number">A </span><span class="title-name">Troubleshooting</span></a></li><li><a href="app-naming.html" class=" "><span class="title-number">B </span><span class="title-name">Naming Conventions</span></a></li><li><a href="app-ha-management.html" class=" "><span class="title-number">C </span><span class="title-name">Cluster Management Tools (Command Line)</span></a></li><li><a href="app-crmreport-nonroot.html" class=" "><span class="title-number">D </span><span class="title-name">Running Cluster Reports Without <code class="systemitem">root</code> Access</span></a></li></ol></li><li><a href="gl-heartb.html" class=" "><span class="title-number"> </span><span class="title-name">Glossary</span></a></li><li><a href="bk02ape.html" class=" "><span class="title-number">E </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section xml:lang="en" class="chapter" id="sec-ha-config-basics-remote" data-id-title="Managing Services on Remote Hosts"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname">SUSE Linux Enterprise High Availability</span> <span class="productnumber">15 SP2</span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">9 </span><span class="title-name">Managing Services on Remote Hosts</span></span> <a title="Permalink" class="permalink" href="sec-ha-config-basics-remote.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP2/xml/ha_remote_hosts.xml" title="Edit source document"> </a></div></div></div><div><div class="abstract"><p>
    The possibilities for monitoring and managing services on remote hosts
    has become increasingly important during the last few years.
    SUSE Linux Enterprise High Availability 11 SP3 offered fine-grained monitoring of services on
    remote hosts via monitoring plug-ins. The recent addition of the
    <code class="literal">pacemaker_remote</code> service now allows SUSE Linux Enterprise High Availability
    15 SP2 to fully manage and monitor resources on remote hosts
    just as if they were a real cluster node—without the need to
    install the cluster stack on the remote machines.
   </p></div></div></div></div><section class="sect1" id="sec-ha-config-basics-remote-nagios" data-id-title="Monitoring Services on Remote Hosts with Monitoring Plug-ins"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">9.1 </span><span class="title-name">Monitoring Services on Remote Hosts with Monitoring Plug-ins</span></span> <a title="Permalink" class="permalink" href="sec-ha-config-basics-remote.html#sec-ha-config-basics-remote-nagios">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP2/xml/ha_remote_hosts.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Monitoring of virtual machines can be done with the VM agent (which only
    checks if the guest shows up in the hypervisor), or by external scripts
    called from the VirtualDomain or Xen agent. Up to now, more fine-grained
    monitoring was only possible with a full setup of the High Availability stack
    within the virtual machines.
   </p><p>
    By providing support for monitoring plug-ins (formerly named Nagios
    plug-ins), SUSE Linux Enterprise High Availability now also allows you to monitor services on
    remote hosts. You can collect external statuses on the guests without
    modifying the guest image. For example, VM guests might run Web services
    or simple network resources that need to be accessible. With the Nagios
    resource agents, you can now monitor the Web service or the network
    resource on the guest. If these services are not reachable anymore,
    SUSE Linux Enterprise High Availability triggers a restart or migration of the respective guest.
   </p><p>
    If your guests depend on a service (for example, an NFS server to be
    used by the guest), the service can either be an ordinary resource,
    managed by the cluster, or an external service that is monitored with
    Nagios resources instead.
   </p><p>
    To configure the Nagios resources, the following packages must be
    installed on the host:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      <span class="package">monitoring-plugins</span>
     </p></li><li class="listitem"><p>
      <span class="package">monitoring-plugins-metadata</span>
     </p></li></ul></div><p>
    YaST or Zypper will resolve any dependencies on further packages,
    if required.
   </p><p>
    A typical use case is to configure the monitoring plug-ins as resources
    belonging to a resource container, which usually is a VM. The container
    will be restarted if any of its resources has failed. Refer to
    <a class="xref" href="sec-ha-config-basics-remote.html#ex-ha-nagios-config" title="Configuring Resources for Monitoring Plug-ins">Example 9.1, “Configuring Resources for Monitoring Plug-ins”</a> for a configuration example.
    Alternatively, Nagios resource agents can also be configured as ordinary
    resources to use them for monitoring hosts or services via the network.
   </p><div class="complex-example"><div class="example" id="ex-ha-nagios-config" data-id-title="Configuring Resources for Monitoring Plug-ins"><div class="title-container"><div class="example-title-wrap"><div class="example-title"><span class="title-number-name"><span class="title-number">Example 9.1: </span><span class="title-name">Configuring Resources for Monitoring Plug-ins </span></span><a title="Permalink" class="permalink" href="sec-ha-config-basics-remote.html#ex-ha-nagios-config">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP2/xml/ha_remote_hosts.xml" title="Edit source document"> </a></div></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">primitive vm1 VirtualDomain \
    params hypervisor="qemu:///system" config="/etc/libvirt/qemu/vm1.xml" \
    op start interval="0" timeout="90" \
    op stop interval="0" timeout="90" \
    op monitor interval="10" timeout="30"
primitive vm1-sshd nagios:check_tcp \
    params hostname="vm1" port="22" \ <span class="callout" id="co-nagios-hostname">1</span>
    op start interval="0" timeout="120" \ <span class="callout" id="co-nagios-startinterval">2</span>
    op monitor interval="10"
group g-vm1-and-services vm1 vm1-sshd \
    meta container="vm1" <span class="callout" id="co-nagios-container">3</span></pre></div><div class="calloutlist"><table style="border: 0; "><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-nagios-hostname"><span class="callout">1</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
       The supported parameters are the same as the long options of a
       monitoring plug-in. Monitoring plug-ins connect to services with the
       parameter <code class="literal">hostname</code>. Therefore the attribute's
       value must be a resolvable host name or an IP address.
      </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-nagios-startinterval"><span class="callout">2</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
       As it takes some time to get the guest operating system up and its
       services running, the start timeout of the monitoring resource must
       be long enough.
      </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-nagios-container"><span class="callout">3</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
       A cluster resource container of type
       <code class="literal">ocf:heartbeat:Xen</code>,
       <code class="literal">ocf:heartbeat:VirtualDomain</code> or
       <code class="literal">ocf:heartbeat:lxc</code>. It can either be a VM or a
       Linux Container.
      </p></td></tr></table></div><p>
     The example above contains only one resource for the
     <code class="literal">check_tcp</code>plug-in, but multiple resources for
     different plug-in types can be configured (for example,
     <code class="literal">check_http</code> or <code class="literal">check_udp</code>).
    </p><p>
     If the host names of the services are the same, the
     <code class="literal">hostname</code> parameter can also be specified for the
     group, instead of adding it to the individual primitives. For example:
    </p><div class="verbatim-wrap"><pre class="screen">group g-vm1-and-services vm1 vm1-sshd vm1-httpd \
     meta container="vm1" \
     params hostname="vm1"</pre></div><p>
     If any of the services monitored by the monitoring plug-ins fail within
     the VM, the cluster will detect that and restart the container resource
     (the VM). Which action to take in this case can be configured by
     specifying the <code class="literal">on-fail</code> attribute for the service's
     monitoring operation. It defaults to
     <code class="literal">restart-container</code>.
    </p><p>
     Failure counts of services will be taken into account when considering
     the VM's migration-threshold.
    </p></div></div></div></section><section class="sect1" id="sec-ha-config-basics-remote-pace-remote" data-id-title="Managing Services on Remote Nodes with pacemaker_remote"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">9.2 </span><span class="title-name">Managing Services on Remote Nodes with <code class="literal">pacemaker_remote</code></span></span> <a title="Permalink" class="permalink" href="sec-ha-config-basics-remote.html#sec-ha-config-basics-remote-pace-remote">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sleha/edit/maintenance/SLEHA15SP2/xml/ha_remote_hosts.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    With the <code class="literal">pacemaker_remote</code> service, High Availability clusters
    can be extended to virtual nodes or remote bare-metal machines. They do
    not need to run the cluster stack to become members of the cluster.
   </p><p>
    SUSE Linux Enterprise High Availability can now launch virtual environments (KVM and LXC), plus
    the resources that live within those virtual environments without
    requiring the virtual environments to run Pacemaker or Corosync.
   </p><p>
    For the use case of managing both virtual machines as cluster resources
    plus the resources that live within the VMs, you can now use the
    following setup:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      The <span class="quote">“<span class="quote">normal</span>”</span> (bare-metal) cluster nodes run
      SUSE Linux Enterprise High Availability.
     </p></li><li class="listitem"><p>
      The virtual machines run the <code class="literal">pacemaker_remote</code>
      service (almost no configuration required on the VM's side).
     </p></li><li class="listitem"><p>
      The cluster stack on the <span class="quote">“<span class="quote">normal</span>”</span> cluster nodes launches
      the VMs and connects to the <code class="literal">pacemaker_remote</code>
      service running on the VMs to integrate them as remote nodes into the
      cluster.
     </p></li></ul></div><p>
    As the remote nodes do not have the cluster stack installed, this has
    the following implications:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      Remote nodes do not take part in quorum.
     </p></li><li class="listitem"><p>
      Remote nodes cannot become the DC.
     </p></li><li class="listitem"><p>
      Remote nodes are not bound by the scalability limits (Corosync
      has a member limit of 32 nodes).
     </p></li></ul></div><p>
    Find more information about the <code class="literal">remote_pacemaker</code>
    service, including multiple use cases with detailed setup instructions
    in <span class="intraxref">Article “Pacemaker Remote Quick Start”</span>.
   </p></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-ha-manage-resources.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 8 </span>Managing Cluster Resources</span></a> </div><div><a class="pagination-link next" href="cha-ha-agents.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 10 </span>Adding or Modifying Resource Agents</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="sec-ha-config-basics-remote.html#sec-ha-config-basics-remote-nagios"><span class="title-number">9.1 </span><span class="title-name">Monitoring Services on Remote Hosts with Monitoring Plug-ins</span></a></span></li><li><span class="sect1"><a href="sec-ha-config-basics-remote.html#sec-ha-config-basics-remote-pace-remote"><span class="title-number">9.2 </span><span class="title-name">Managing Services on Remote Nodes with <code class="literal">pacemaker_remote</code></span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>